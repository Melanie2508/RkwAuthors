{namespace rkwAuthors=RKW\RkwAuthors\ViewHelpers}

<div class="tile">
    <div class="tile__header">
        <div class="tile__img">
            <f:render section="Image" arguments="{_all}" />
        </div>
    </div>
    <div class="tile__content">
        <f:render section="Name" arguments="{_all}" />
        <div class="tile__contact my-1">
            <f:render section="Email" arguments="{_all}" />
            <f:render section="Phone" arguments="{_all}" />
            <f:render section="Link" arguments="{_all}" />
        </div>
    </div>
</div>

<!-- ======================================================================== -->

<f:section name="Image">
    <f:if condition="{author.internal} && {author.imageBoxes}">
        <f:then>
            <f:image src="{author.imageBoxes.uid}" treatIdAsReference="1" alt="<rkwAuthors:GetCombinedName author='{author}'/>" width="350"  />
        </f:then>
        <f:else>
            <f:image src="EXT:rkw_authors/Resources/Public/Images/author-list-fallback.png" alt="<rkwAuthors:GetCombinedName author='{author}'/>" width="350"  />
        </f:else>
    </f:if>
</f:section>

<!-- ======================================================================== -->

<f:section name="Name">
    <h3 class="tile__title icon">
        <span class="tile__title-icon">
            <svg class="icon icon--32"><use xlink:href="#ic-contacts" /></svg>
        </span>
        <span>
            <span class="tile__title-text">
                <f:format.crop maxCharacters="60" respectWordBoundaries="FALSE"><rkwAuthors:GetCombinedName author="{author}" /></f:format.crop>
            </span>
        <!--{author.functionTitle}-->
        </span>
    </h3>
</f:section>


<!-- ======================================================================== -->

<f:section name="Link">
    <f:if condition="{author.internal} && {showPid}">
        <f:then>
            <f:link.action action="show" pageUid="{showPid}" arguments="{author: '{author}'}" target="{f:if(condition: '{settings.detailLinkTargetBlank} == 1', then: '_blank')}" class="tile__link-overlay" title="<rkwAuthors:GetCombinedName author='{author}'/>" >
                <rkwAuthors:GetCombinedName author='{author}'/>
            </f:link.action>
        </f:then>
        <f:else>
            <f:if condition="{author.url}">
                <f:link.external uri="{author.url}" target="_blank" class="tile__link-overlay" title="<rkwAuthors:GetCombinedName author='{author}'/>" >
                    <rkwAuthors:GetCombinedName author='{author}'/>
                </f:link.external>
            </f:if>
        </f:else>
    </f:if>
</f:section>

<!-- ======================================================================== -->

<f:section name="Phone">
    <f:if condition="{author.phone} && {author.phone2}">
        <div class="tile__contact-text">
            <svg class="icon icon--16">
                <use xlink:href="#ic-phone" />
            </svg>
            <f:if condition="{author.internal}">
                <f:then>
                    <rkwAuthors:GetFormattedPhoneNumber phoneExtensionLength="{settings.phoneExtensionLength}" author="{author}"/>
                </f:then>
                <f:else>
                    <rkwAuthors:GetFormattedPhoneNumber phoneExtensionLength="0" author="{author}"/>
                </f:else>
            </f:if>
        </div>
    </f:if>
</f:section>

<!-- ======================================================================== -->

<f:section name="Email">
    <f:if condition="{author.email} || {rkwAuthors:ifContactFormIsActive(author:'{author}')}">
        <div class="tile__contact-link">
            <svg class="icon icon--16">
                <use xlink:href="#ic-mail" />
            </svg>
            <f:if condition='<rkwAuthors:ifContactFormIsActive author="{author}" />'>
                <f:then>
                    <f:link.page pageUid="{settings.contactForm.pageUid}" additionalParams="{tx_rkwauthors_rkwauthorscontactform: {author: author}}">
                        <f:translate key="partials.authors.pages.box.clickForForm" />
                    </f:link.page>
                </f:then>
                <f:else>
                    <f:link.email email="{author.email}">
                        <f:translate key="partials.authors.pages.box.clickToWriteEmail" />
                    </f:link.email>
                </f:else>
            </f:if>

        </div>
    </f:if>
</f:section>
